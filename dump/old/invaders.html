<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.1.min.js" type="text/javascript" charset="utf-8"></script>

<script>
$(document).ready(function(){

	var shots = 0;
	var txt = "Isto é um exemplo do texto que podia ser Isto é um exemplo do texto que podia ser Isto é um exemplo do texto que podia ser Isto é um exemplo do texto que podia ser";

	init(txt);

function init(txt) {
	txt = txt.split(' ');
	txtSpan = $(txt).map(function(i, c){
		return "<span id='t"+ i +"'>"+ c +"</span>";
	}).get().join(' ');
	$('#text').html(txtSpan);
}


// ------------------------------------------------ keyboard

$("body").keydown(function(key) {
	if(key.which == 37){
		movePad('left');
	} else if(key.which == 39){
		movePad('right');
	}	
	else if(key.which == 32){

  	$("body").append($("<div id='shot"+shots+"' class='shot'/>"));
  	currShot = $("#shot"+shots);

  	padCenter = $('#pad').offset()['left'] + $('#pad').width()/2;
  	padTop = $('#pad').offset()['top'];

  	currShot.css('top', padTop+'px');
  	currShot.css('left', padCenter+'px');

  	$("#shot"+shots).animate({
  		top: '0px',
	},
	{
	duration: 2000,
  	step: function(now, fx) {
  		if(colliding(fx.elem, $("#text"))){
			$(this).stop();
			$(fx.elem).remove();
  		} 
    	var data = fx.elem.id + ' ' + fx.prop + ': ' + now;
    	//console.log('<div>' + data + '</div>');
  	},
  	complete: function(){
  		$(this).remove();
  	}
	});

	shots++;
  }
});

$("body").keydown(function(key){
	if(key.which == 37){
		movePad('left');
	} else if(key.which == 39){
		movePad('right');
	}
});

// ---------------------------------------- padMovement
function movePad(dir){
	pad = $('#pad');
	if(dir == 'left')
		pad.animate({'left': '-=15'}, 10);
	else
		pad.animate({'left': '+=15'}, 10);
}


// ---------------------------------------- positions

function getPositions(box) {
	var $box = $(box);
	var pos = $box.offset();
	var width = $box.width();
	var height = $box.height();
	return [ [ pos.left, pos.left + width ], [ pos.top, pos.top + height ] ];
}

function colliding(e1, e2){
	pe1 = getPositions(e1);
	pe2 = getPositions(e2);
	collided = false;
	if(pe1[1][0] <= pe2[1][1]){
		$('#text span').each(function(){
			pspan = getPositions(this);
			if(!$(this).hasClass('invisible'))
				if(pspan[0][0] <= pe1[0][1] && pspan[0][1] >= pe1[0][0])
					if(pspan[1][1]+5 >= pe1[1][0]){
						console.log(this);
						$(this).addClass('invisible');
						collided = true;
						return false;
				}
		});
		if(collided) return true;
	}

}

});
</script>


<style type="text/css" media="screen">
	.invisible{
		color:white;
	}
	.shot {
		width:4px; height:16px; background:black; position:absolute;
	}
	#pad {
		width:80px; height:15px; position:absolute; top:400px; left:100px; background:black;
	}
</style>
</head>
<body>
    <div id="text" style="width:500px; font-size:1.5em;position:absolute; top:50px; left:100px">
    	Isto é um exemplo do texto que podia ser Isto é um exemplo do texto que podia ser Isto é um exemplo do texto que podia ser Isto é um exemplo do texto que podia ser 
    </div>

    <div id="pad">
    	&nbsp;
    </div>

</body>
</html> 